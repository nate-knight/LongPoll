@{
    ViewBag.Title = "Chatty Chat Chat";
}

<script type="text/javascript">

    $(document).ready(function () {

        $(".btn-submit").click(function () {

            //send chat message to server
            $.ajax({
                type: "POST",
                url: "/chat/PostMessage",
                data: {message: $("#txtMessage").val()}
            })

            //reset textbox
            $("#txtMessage").val("").focus();

            
        });


        (function longPoll() {

            $.ajax({
                type: "POST",
                url: "chat/longPoll",
                success: function (message) {
                    //when response is recieved, update list
                    $("<li>").text(message).appendTo("#messages");
                },
                error: function( jqXHR ,  textStatus,  errorThrown){
                    console.log("error: " + errorThrown);
                },
                complete: longPoll //call function again after either success or error.
            });

        })();

    });

</script>

<h2>Chat</h2>

<div class="message-container">
    <ul id="messages"></ul>
</div>

<div class="input-holder"><input type="text" id="txtMessage" placeholder="say something" /></div>
<div class="button-holder"><button class="btn-submit btn btn-default btn-large">Send</button></div>




 


